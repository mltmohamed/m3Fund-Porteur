<div class="nouveau-projet-container">
  <div class="form-card">
    <h1 class="form-title">Créer un nouveau projet</h1>
    <p class="form-subtitle">Bienvenu ! Prêt à créer votre projet ? veuillez remplir les champs ci-dessous.</p>

    <!-- Messages d'erreur et de succès -->
    <div *ngIf="errorMessage" class="error-message" (click)="clearError()">
      <i class="fas fa-exclamation-circle"></i>
      {{ errorMessage }}
    </div>
    
    <div *ngIf="successMessage" class="success-message" (click)="clearSuccess()">
      <i class="fas fa-check-circle"></i>
      {{ successMessage }}
    </div>

    <!-- Avertissement si l'utilisateur n'est pas vérifié -->
    <div *ngIf="!isUserVerified" class="verification-warning">
      <i class="fas fa-exclamation-triangle"></i>
      <div class="warning-content">
        <strong>Compte non vérifié</strong>
        <p>Votre compte doit être vérifié par un administrateur avant de pouvoir créer des projets. Veuillez patienter pendant que votre compte est en cours de vérification.</p>
      </div>
    </div>

    <form class="project-form" (ngSubmit)="onSubmit()" [class.disabled]="!isUserVerified">
      <div class="form-columns">
        <!-- Colonne gauche -->
        <div class="form-column">
          <div class="form-group">
            <label for="projectName">Nom du Projet</label>
            <input 
              type="text" 
              id="projectName" 
              class="form-input" 
              [(ngModel)]="projectName"
              name="projectName"
              placeholder="Nom du projet"
            >
          </div>
          
          <div class="form-group">
            <label for="projectSummary">Résumé du projet</label>
            <input 
              type="text" 
              id="projectSummary" 
              class="form-input" 
              [(ngModel)]="projectSummary"
              name="projectSummary"
              placeholder="Résumé du projet"
            >
          </div>
          
          <div class="form-group">
            <label for="projectLink">Un lien à partager?</label>
            <input 
              type="url" 
              id="projectLink" 
              class="form-input" 
              [(ngModel)]="projectLink"
              name="projectLink"
              placeholder="https://monsite.com ou monsite.com"
            >
          </div>
          
          <div class="form-group">
            <label>Une vidéo pitch?</label>
            <div class="file-upload" (click)="onVideoSelect()">
              <i class="fas fa-upload"></i>
              <span *ngIf="!selectedVideo">Sélectionner une vidéo</span>
              <span *ngIf="selectedVideo" class="file-selected">{{ selectedVideo.name }}</span>
            </div>
          </div>
          
          <div class="form-group">
            <label for="projectDescription">Décrivez votre projet</label>
            <textarea 
              id="projectDescription" 
              class="form-textarea" 
              rows="6"
              [(ngModel)]="projectDescription"
              name="projectDescription"
              placeholder="Décrivez votre projet en détail..."
            ></textarea>
          </div>
        </div>

        <!-- Colonne droite -->
        <div class="form-column">
          <div class="form-group">
            <label for="projectDomain">Domaine Concerné</label>
            <div class="select-container">
              <select 
                id="projectDomain" 
                class="form-select" 
                [(ngModel)]="projectDomain"
                name="projectDomain"
              >
                <option *ngFor="let option of domainOptions" [value]="option.value">
                  {{ option.label }}
                </option>
              </select>
              <i class="fas fa-chevron-down"></i>
            </div>
          </div>
          
          <div class="form-group">
            <label for="projectObjective">Objectif du projet</label>
            <input 
              type="text" 
              id="projectObjective" 
              class="form-input" 
              [(ngModel)]="projectObjective"
              name="projectObjective"
              placeholder="Objectif du projet"
            >
          </div>
          
          <div class="form-group">
            <label>Des images du projet à partager?</label>
            <div class="file-upload" (click)="onImagesSelect()">
              <i class="fas fa-upload"></i>
              <span *ngIf="selectedImages.length === 0">Sélectionner des images</span>
              <span *ngIf="selectedImages.length > 0" class="file-selected">{{ selectedImages.length }} image(s) sélectionnée(s)</span>
            </div>
          </div>
          
          <div class="form-group">
            <label>Le Business Plan du projet</label>
            <div class="file-upload" (click)="onBusinessPlanSelect()">
              <i class="fas fa-upload"></i>
              <span *ngIf="!selectedBusinessPlan">Sélectionner un fichier</span>
              <span *ngIf="selectedBusinessPlan" class="file-selected">{{ selectedBusinessPlan.name }}</span>
            </div>
          </div>
          
          <div class="form-group">
            <label for="startDate">Date de debut</label>
            <div class="date-input-container">
              <i class="fas fa-calendar-alt"></i>
              <input 
                type="date" 
                id="startDate" 
                class="form-input date-input" 
                [(ngModel)]="startDate"
                name="startDate"
                [max]="getMaxDate()"
                (change)="validateStartDate()"
              >
            </div>
            <div *ngIf="errorMessage && (errorMessage.includes('date de lancement') || errorMessage.includes('date de début'))" class="error-message" style="color: red; margin-top: 5px; font-size: 0.875rem;">
              {{ errorMessage }}
            </div>
          </div>
          
        </div>
      </div>

      <!-- Bouton de soumission -->
      <div class="form-submit">
        <button type="submit" class="submit-btn" [disabled]="isLoading || !isUserVerified">
          <i *ngIf="isLoading" class="fas fa-spinner fa-spin"></i>
          <span *ngIf="!isLoading">Soumettre le projet</span>
          <span *ngIf="isLoading">Création en cours...</span>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de succès -->
<div *ngIf="showSuccessModal" class="modal-overlay" (click)="closeSuccessModal()">
  <div class="success-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="success-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <h2>Projet créé avec succès !</h2>
    </div>
    
    <div class="modal-body">
      <p>Votre projet a été créé avec succès et sera examiné par nos équipes.</p>
      <p>Vous recevrez une notification une fois la validation terminée.</p>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn-secondary" (click)="closeSuccessModal()">
        Créer un autre projet
      </button>
      <button type="button" class="btn-primary" (click)="goToProjects()">
        Voir mes projets
      </button>
    </div>
  </div>
</div>

