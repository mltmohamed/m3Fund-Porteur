<div class="registration-page">
  <div class="registration-container">
    <div class="logo-header">
      <img src="/logo.png" alt="m3Fund Logo" />
    </div>
    <!-- Titre de la page -->
    <div class="title-section">
      <h1 class="main-title">Inscription</h1>
      <p class="subtitle">Créer un compte pour commencer</p>
    </div>

    <!-- Messages d'erreur et de succès -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>
    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>
  
      <!-- Formulaire -->
      <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()" class="registration-form">
        <div class="form-columns">
          <!-- Colonne gauche -->
          <div class="form-column left-column">
            <div class="form-group">
              <label for="nom">Nom</label>
              <input 
                type="text" 
                id="nom" 
                formControlName="lastName" 
                class="form-input"
                [class.error]="lastName?.invalid && lastName?.touched">
              <div *ngIf="lastName?.invalid && lastName?.touched" class="error-text">
                <span *ngIf="lastName?.errors?.['required']">Le nom est requis</span>
                <span *ngIf="lastName?.errors?.['minlength']">Le nom doit contenir au moins 2 caractères</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="prenom">Prénom</label>
              <input 
                type="text" 
                id="prenom" 
                formControlName="firstName" 
                class="form-input"
                [class.error]="firstName?.invalid && firstName?.touched">
              <div *ngIf="firstName?.invalid && firstName?.touched" class="error-text">
                <span *ngIf="firstName?.errors?.['required']">Le prénom est requis</span>
                <span *ngIf="firstName?.errors?.['minlength']">Le prénom doit contenir au moins 2 caractères</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="telephone">Numéro de téléphone</label>
              <input 
                type="tel" 
                id="telephone" 
                formControlName="phone" 
                class="form-input"
                [class.error]="phone?.invalid && phone?.touched">
              <div *ngIf="phone?.invalid && phone?.touched" class="error-text">
                <span *ngIf="phone?.errors?.['required']">Le numéro de téléphone est requis</span>
                <span *ngIf="phone?.errors?.['pattern']">Le numéro de téléphone doit inclure l'indicatif international (ex: +223 71234567)</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="email">Email</label>
              <input 
                type="email" 
                id="email" 
                formControlName="email" 
                class="form-input"
                [class.error]="email?.invalid && email?.touched">
              <div *ngIf="email?.invalid && email?.touched" class="error-text">
                <span *ngIf="email?.errors?.['required']">L'email est requis</span>
                <span *ngIf="email?.errors?.['email']">Format d'email invalide</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="adresse">Adresse</label>
              <input 
                type="text" 
                id="adresse" 
                formControlName="address" 
                class="form-input"
                [class.error]="address?.invalid && address?.touched">
              <div *ngIf="address?.invalid && address?.touched" class="error-text">
                <span *ngIf="address?.errors?.['required']">L'adresse est requise</span>
                <span *ngIf="address?.errors?.['minlength']">L'adresse doit contenir au moins 5 caractères</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="carte-biometrique">Carte Biométrique *</label>
              <div class="file-input-container">
                <input 
                  type="file" 
                  id="carte-biometrique" 
                  (change)="onFileSelected($event, 'biometricCard')" 
                  accept=".pdf,.jpg,.jpeg,.png"
                  class="file-input-hidden">
                <div class="file-input-display">
                  <span class="file-input-text">{{ biometricCardFileName || 'Sélectionner un fichier' }}</span>
                  <button type="button" class="file-upload-btn" (click)="triggerFileInput('carte-biometrique')">
                    <i class="fas fa-upload"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="biometricCard?.invalid && biometricCard?.touched" class="error-text">
                <span *ngIf="biometricCard?.errors?.['required']">La carte biométrique est obligatoire</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="certificat-residence">Certificat de residence *</label>
              <div class="file-input-container">
                <input 
                  type="file" 
                  id="certificat-residence" 
                  (change)="onFileSelected($event, 'residenceCertificate')" 
                  accept=".pdf,.jpg,.jpeg,.png"
                  class="file-input-hidden">
                <div class="file-input-display">
                  <span class="file-input-text">{{ residenceCertificateFileName || 'Sélectionner un fichier' }}</span>
                  <button type="button" class="file-upload-btn" (click)="triggerFileInput('certificat-residence')">
                    <i class="fas fa-upload"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="residenceCertificate?.invalid && residenceCertificate?.touched" class="error-text">
                <span *ngIf="residenceCertificate?.errors?.['required']">Le certificat de résidence est obligatoire</span>
              </div>
            </div>
          </div>
  
          <!-- Colonne droite -->
          <div class="form-column right-column">
            <div class="form-group">
              <label for="revenu-annuel">Revenu annuel</label>
              <input 
                type="number" 
                id="revenu-annuel" 
                formControlName="annualIncome" 
                class="form-input"
                [class.error]="annualIncome?.invalid && annualIncome?.touched">
              <div *ngIf="annualIncome?.invalid && annualIncome?.touched" class="error-text">
                <span *ngIf="annualIncome?.errors?.['required']">Le revenu annuel est requis</span>
                <span *ngIf="annualIncome?.errors?.['min']">Le revenu doit être positif</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="releve-bancaire">Relevé bancaire</label>
              <div class="file-input-container">
                <input 
                  type="file" 
                  id="releve-bancaire" 
                  (change)="onFileSelected($event, 'bankStatement')" 
                  accept=".pdf,.jpg,.jpeg,.png"
                  class="file-input-hidden">
                <div class="file-input-display">
                  <span class="file-input-text">{{ bankStatementFileName || 'Sélectionner un fichier' }}</span>
                  <button type="button" class="file-upload-btn" (click)="triggerFileInput('releve-bancaire')">
                    <i class="fas fa-upload"></i>
                  </button>
                </div>
              </div>
              <small class="optional-text">(facultatif)</small>
            </div>
  
            <div class="form-group">
              <label for="password">Créer un mot de passe</label>
              <input 
                type="password" 
                id="password" 
                formControlName="password" 
                class="form-input"
                [class.error]="password?.invalid && password?.touched">
              <div *ngIf="password?.invalid && password?.touched" class="error-text">
                <span *ngIf="password?.errors?.['required']">Le mot de passe est requis</span>
                <span *ngIf="password?.errors?.['minlength']">Le mot de passe doit contenir au moins 8 caractères</span>
                <span *ngIf="password?.errors?.['pattern']">Le mot de passe doit contenir au moins une majuscule, une minuscule, un chiffre et un caractère spécial</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="confirm-password">Confirmer le mot de passe</label>
              <input 
                type="password" 
                id="confirm-password" 
                formControlName="confirmPassword" 
                class="form-input"
                [class.error]="confirmPassword?.invalid && confirmPassword?.touched">
              <div *ngIf="confirmPassword?.invalid && confirmPassword?.touched" class="error-text">
                <span *ngIf="confirmPassword?.errors?.['required']">La confirmation du mot de passe est requise</span>
                <span *ngIf="confirmPassword?.errors?.['passwordMismatch']">Les mots de passe ne correspondent pas</span>
              </div>
            </div>
  
            <div class="form-group">
              <label for="photo-profil">Choisissez une photo de profil</label>
              <div class="profile-photo-container">
                <div class="profile-photo">
                  <img 
                    [src]="profilePhotoPreview || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiByeD0iNTAiIGZpbGw9IiNmM2Y0ZjYiLz4KPHN2ZyB4PSIyNSIgeT0iMjUiIHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjAgMjF2LTJhNCA0IDAgMCAwLTQtNEg4YTQgNCAwIDAgMC00IDR2MiIgc3Ryb2tlPSIjOTk5IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiIHN0cm9rZT0iIzk5OSIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPgo8L3N2Zz4K'" 
                    alt="Photo de profil" 
                    class="profile-image">
                  <input 
                    type="file" 
                    id="photo-profil" 
                    (change)="onFileSelected($event, 'profilePhoto')" 
                    accept="image/jpeg,image/png,.jpg,.jpeg,.png"
                    class="file-input-hidden">
                  <button 
                    type="button" 
                    class="camera-btn"
                    (click)="triggerFileInput('photo-profil')">
                    <i class="fas fa-camera"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Boutons d'action -->
        <div class="form-actions">
          <button type="button" class="back-btn" (click)="goBack()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M19 12H5M12 19L5 12L12 5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button 
            type="submit" 
            class="submit-btn" 
            [disabled]="isLoading || registrationForm.invalid">
            <span *ngIf="!isLoading">S'enregistrer</span>
            <span *ngIf="isLoading">Inscription en cours...</span>
          </button>
        </div>
      </form>
    </div>
  